<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">

  <title>RCC</title>
  <style>
body {
    max-width: 40em;
    margin: 0 auto;
}
.code {
    width: 100%;
    height: 20em;
}
#objectcode {
    resize: vertical;
}
code {
    white-space: pre;
    background-color: #ccc;
    padding: .1em;
}
pre {
    width: 100%;
    background-color: #ccc;
    padding: .25em;
}
  </style>
</head>

<body>
    <h2>Source code</h2>
    <div class="code" id="sourcecode">void main() {}</div>
    <button id="compile">Compile</button>
    <h2>Object code</h2>
    <textarea class="code" id="objectcode" readonly="true" autocomplete="false"></textarea>
    <h2>Language reference</h2>
    <!-- LANGUAGE.html -->
<p>A program consists of a single function definition.</p>
<p>A function definition looks like this:</p>
<pre><code>int functionName (int varName, int varName, ...) {
    functionBody
}</code></pre>
<p>or</p>
<pre><code>void functionName (int varName, int varName, ...) {
    functionBody
}</code></pre>
<p>It has a return type (which must be either int or void), a name (any name of your choosing), and a list of zero or more parameters, separated by commas and enclosed in parentheses. Each parameter has a type (which must be int) followed by a parameter name (of your choosing). The function body is enclosed with braces.</p>
<p>A function body is a list of zero or more local variable declarations followed by a list of zero or more statements.</p>
<p>A local variable declaration looks like this:</p>
<pre><code>int varName = constant;</code></pre>
<p>It has a type (which must be int), a variable name (of your choosing), an equals sign, an integer constant, and a semicolon.</p>
<p>There are five kinds of statements:</p>
<ul>
<li><p>An assignment statement looks like this:</p>
<pre><code>varName = exp;</code></pre>
<p>It has a variable name (which must have been previously declared as a parameter or local variable), an equals sign, an integer-valued expression, and a semicolon.</p></li>
<li><p>A return statement looks like this:</p>
<pre><code>return exp;</code></pre>
<p>It has the keyword 'return', an integer-valued expression, and a semicolon. A return statement may appear in a function only if the function's return type is int.</p></li>
<li><p>A conditional statement looks like this:</p>
<pre><code>if (exp) {
    statements
}
else {
    statements
}</code></pre>
<p>It consists of the keyword 'if', a boolean-valued expression enclosed in parentheses, a list of zero or more statements enclosed in braces, the keyword ``else'', and a list of zero or more statements enclosed in braces. The else part is optional, however.</p></li>
<li><p>A while statement looks like this:</p>
<pre><code>while (exp) {
  statements
}</code></pre>
<p>It consists of the keyword 'while', a boolean-valued expression enclosed in parentheses, and a list of zero or more statements enclosed in braces.</p></li>
</ul>
<p>There are many kinds of exps:</p>
<ul>
<li>A previously-declared variable is an integer-valued expression.</li>
<li>An integer constant is an integer-valued expression.</li>
<li>Compound expressions of the form
<ul>
<li><code>exp + exp</code></li>
<li><code>exp - exp</code></li>
<li><code>-exp</code> are integer-valued expressions.</li>
</ul></li>
<li>Compound expressions of the form
<ul>
<li><code>exp &gt; exp</code></li>
<li><code>exp &lt; exp</code></li>
<li><code>exp &gt;= exp</code></li>
<li><code>exp &lt;= exp</code></li>
<li><code>exp == exp</code></li>
<li><code>exp != exp</code> are boolean-valued expressions.</li>
</ul></li>
</ul>
<h2 id="sample-programs">Sample Programs</h1>
<p>This function returns the sum of its two parameters.</p>
<pre><code>int add (int a, int b) {
    return a+b;
}</code></pre>
<p>This function returns the larger of its two parameters.</p>
<pre><code>int largest (int a, int b) {
    if (a &gt; b) {
        return a;
    } else {
        return b;
    }
}</code></pre>
<p>This function orders the three parameters into ascending order.</p>
<pre><code>void sort (int a, int b, int c) {
    int temp = 0;
    if (a &gt; b) {
        temp = a;
        a = b;
        b = temp;
    }
    if (b &gt; c) {
        temp = b;
        b = c;
        c = temp;
    }
    if (a &gt; b) {
        temp = a;
        a = b;
        b = temp;
    }
}</code></pre>
    <!-- end LANGUAGE.html -->
    <hr />
    Reduced-C compiler by Peter Marheine for CS1030. |
    <a href="https://bitbucket.org/tari/reduced-c">Source Code</a>

    <script src="https://cdn.jsdelivr.net/ace/1.2.0/min/ace.js" type="text/javascript" charset="utf-8"></script>
    <script>
        var editor = ace.edit('sourcecode');
        var button = document.getElementById('compile');
        var objectcode = document.getElementById('objectcode');
        editor.getSession().setMode('ace/mode/c_cpp');

        editor.getSession().on('change', function(e) {
            button.disabled = false;
        });

        document.getElementById('compile').onclick = function() {
            button.disabled = true;
            var code = editor.getValue();

            var req = new XMLHttpRequest();
            req.onload = function(e) {
                var code = req.status;
                objectcode.value = req.responseText;
            };
            req.open('POST', 'cgi-bin/rcc.cgi');
            // Page encoding is utf-8 so this is correct.
            req.setRequestHeader('Content-Type', 'text/plain; charset=UTF-8');
            req.send(code);
        }

        button.disabled = false;
        objectcode.value = '';
    </script>
</body>
</html>
